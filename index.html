<html>
<head>
	<script src="https://cdn.firebase.com/js/client/2.0.4/firebase.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>

</head>

<body>
	<div id="container" style="width:100%; height:400px; margin: 0 auto"></div>
</body>

<script type="text/javascript">
	/*
	fetch data from firebase, using callback to achieve realtime updates
	*/
	tempDataRef = new Firebase('https://gen-homework.firebaseio.com/');
	tempDataRef = tempDataRef.child('server-temperature').child('home');

	
	
	//function to update ui

	/*
	create dynamic zoomable timeseries graph using data from firebase
	it should be able to update itself without reloading the page
	*/
	var initGraph = function (dataStore) {
		Highcharts.setOptions({
			global: {
				useUTC: false
			}
		});

	    $('#container').highcharts({
	        chart: {
	            zoomType: 'x'
	        },
	        title: {
	            text: 'Temperature of different locations throughout the day'
	        },
	        subtitle: {
	        	text: 'Click and drag in the plot area to zoom in'
	        },
	        xAxis: {
	        	type: 'datetime'
	            //tickInterval: 1*1000,
	        },
	        yAxis: {
	            title: {
	                text: 'Temperature'
	            }
	        },
		    series: [{
		    	type: 'line',
		        name: 'Location Temperature Over Time',    //dynamic needed
		        data: []
		    }]
	    });

	    dataStore.on('child_added',function(snapshot){
		var newTime = parseInt(snapshot.key());
		var newTemp = snapshot.val().Temperature;
		var chart = $('#container').highcharts();
		//var dateObj = new Date(newTime);
		//console.log(newTime + '\n');
		//console.log(dateObj+'\n');
		//console.log(snapshot.val().Temperature+'\n');
		chart.series[0].addPoint([newTime, newTemp],true,false,true);
		});
	};	

	initGraph(tempDataRef);
	

</script>

</html>